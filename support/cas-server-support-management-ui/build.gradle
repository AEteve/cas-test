plugins {
  id "java"
  id "com.github.node-gradle.node" version "4.0.0"
}

node {
    version = '16.14.2'
    yarnVersion = ''
    download = true
}

def yarn = tasks.named("yarn")

tasks.register("buildWebapp", NpxTask) {
    command = "vite"
    args = [
        "build"
    ]
    dependsOn(build, yarn)
    inputs.dir(fileTree("src/main/resources/ui").exclude("**/*.test.js").exclude("**/*.spec.js").exclude("**/__tests__/**/*.js"))
    inputs.dir("node_modules")
    inputs.dir("public")
    outputs.dir("${buildDir}")
    environment = ["BUILD_PATH": "${buildDir}"]
}
